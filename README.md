# Default Sensitivity


The default sensitivity test in Scenario Manager is implemented by setting the default time of the perturbed obligor to be the valuation date when the present value of each tranche is calculated, no matter when that obligor defaults in the generated Monte Carlo scenarios. Compared with other models, the implementation of Scenario Manager model is simple, direct, and efficient. However, the joint default events generated in the MC scenarios remain unchanged, which is an approximation of the realistic situation.

Through testing we have found that this approximation is good when the correlation is weak. In general the Scenario Manager model can be viewed as an intermediate one between the models with 30,000 bps credit spread shock to the perturbed obligor and the model with no correlation between the perturbed obligor and the other obligors in the portfolio.  


The Risk Engine has two functions: default sensitivity test and credit spread sensitivity test. It is implemented by the Scenario Manager, an autorun program, which manages the calculation of MTM value of the deal and the sensitivity Greeks. 

Default sensitivity test is a kind of stress tests matching the situation that a credit default event of an obligor has occurred or is perceived to be imminent. It is implemented by finding the change of Present Value (PV) for the tranches when the default time of an obligor is perturbed. The Scenario Manager Model is implemented by setting the default time of each obligor to be the valuation date when calculating the present value of each tranche, no matter when that obligor defaults in the generated Monte Carlo (MC) scenarios. The default sensitivities (Delta) for the jth tranche is defined as  

 ,

where  (N=number of obligors in the portfolio) is the survival time of the perturbed obligor. In this measure both the default times of the perturbed obligor seen by other obligors in the portfolio and the default correlations between the perturbed obligor and other obligors remain unchanged. This is not realistic because the MC paths of all the other obligors are generated without the updated information that the perturbed obligor has defaulted. We only perturbed the primitive default time of the perturbed obligor to be the valuation date while the joint default events incurred by this perturbed obligor is not re-simulated accordingly.    

In order to test the Scenario Manager model, three other measures of default sensitivity which sound reasonable are considered:

•	Option 1. The tested obligor is perturbed by giving a 30,000 bps credit spread shock. With current risk free rates the mean survival time of the tested obligor is about 2.5 months. In this model the default correlation is calculated directly from the changed hazard rate and MC paths are simulated with the updated information. The Deltas for the jth tranche is given by

 ,

where  is the credit spread of perturbed  ith obligor.

•	Option 2. This model is implemented by constructing a new portfolio in which the perturbed obligor is excluded and the principal of most junior tranche (usually the first tranche) is reduced by the Loss Given Default (LGD) of the perturbed obligor. In this model, there is absolutely no correlation between the perturbed obligor and the rest of the portfolio. Given a set of N obligors and its subset Ai which includes the ith obligor, the default sensitivity for the jth tranche is defined as

 .
 

•	Option 3. In this model the default time of the perturbed obligor is set to be valuation date in the process of the MC simulation. The default correlation is unchanged while the information that the perturbed obligor has defaulted is updated, when the MC paths are generated. 


The test of the risk engine was conducted in two phases. In the first phase, a test model which serves the same function as Scenario Manager was implemented. The pricing of the Scenario Manager model for three deals was then tested against the test implementation (ref. https://finpricing.com/lib/FiZeroBond.html). In the second phase of the test, the default sensitivity was simulated by the test implementation and compared with the results of Scenario Manager. The methodology of default sensitivity test was also discussed and compared with three other possible options of the default sensitivity test to check the effect of correlation and accuracy of the model.

The error is computed as

	 

with

	 ,

where max and min are the maximum and minimum prices in eight simulations with different random seeds.

We first compared the default sensitivity results generated by our test model and the Scenario Manager model. Then based on a test deal, the methodology and accuracy of the Scenario Manager model were checked and compared with three other default sensitivity measures. 


The main concern of the Scenario Manager model is the effect of correlation between the perturbed obligor and the other obligors in the portfolio, or in other words, how other obligors react to the new information that the perturbed obligor has defaulted. In Scenario Manager model this information is not taken into account and the default correlation remains unchanged. 

Note that deltas for ρ=0.3 is the value predicted by the Scenario Manager. Two trends can be found. First, the stronger the correlation, the more joint default events which lead to a decrease of Delta in the junior tranche and an increase in the senior tranche. Second, the change of Delta is small and within the range of simulation noise when correlation strength changes from 0 to 0.3. Deviations become large when ρ=0.5 and ρ=0.7.

We can come to the following conclusions:

1)	The Scenario Manager model is very close to Option 1 and Option 2. 
2)	In Option 1, Deltas of the first tranche generally have a very small negative shift, indicating that the Scenario Manager model has less joint default events. Option 1 is the one that shock the credit spread to 30,000bps for the perturbed obligor. The perturbed obligor has very small survival time (not zero) and preserves the correlation over time. In the Scenario Manager model the survival time of the perturbed obligor in a scenario is very large so it will have less joint default events compared with Option 1.
3)	In Option 2, Deltas of the first tranche generally have a very small positive shift. In this model there is no correlation between perturbed obligor and the rest of the portfolio hence has less joint default events compared with the Scenario Manager model. This also implies that the correlation structure of the Scenario Manager model is directionally correct, although it is unrealistic. 
4)	It seems counter intuitive that Option 1 and Option 2 are quite close. In Option 1, the correlation is fully considered while in Option 2 no correlation is taken into account. According to our theory, default correlation between two obligors should meet

 ,

where   is the hazard rate.  If we increase the credit spread of the perturbed obligor by 30,000 bps, then the default correlation between the perturbed obligor and the rest of the portfolio becomes very small. So the results calculated by Option 1 does not change dramatically from the results without correlation between the perturbed obligor and the other obligors in the portfolio.
5)	Option 3 behaves quite differently from three other models. There are more joint default events because this model holds the original default correlations and sets the default time of the perturbed obligor to be valuation date. More joint default events are incurred by the perturbed obligor because of its early default time and strong default correlation.

The default sensitivity model of Scenario Manager has been tested and found to be adequate for the purpose of default sensitivity test. The Scenario manager model resets the default time of the perturbed obligor to be the valuation date after the MC simulation paths have been generated. The implementation is thus simple and efficient. However in this measure the default correlation between the perturbed obligor and other obligors in the portfolio remains unchanged and the new information that the perturbed obligor has defaulted is not observed by other obligors. This will lead to unrealistic joint default events, which are generated in the MC simulation. Fortunately, we have shown that, if the correlation between the perturbed obligor and the other obligors in the portfolio is weak, this approximation is probably good enough.

The Scenario Manager model can be viewed as an intermediate one between Option 1 and Option 2, in which a default correlation effect is fully considered and no correlation effect is taken into account, respectively. Option 1 in which the credit spread of the perturbed obligor is shocked by 30,000 bps seems to be a more reasonable model for the default sensitivity test. The agreement between the Scenario Manage model and Option 1 indicates that the Scenario Manager model might be a good alternative one, especially when the Scenario Manager model is more efficient.

The joint default events predicted by Option 1 might be still underestimated due to an undervalued default correlation in the theoretical framework. Option 3 may provide a better estimation or at least provides an upper boundary when correlation is fairly large. 

Because in the sensitivity test the obligors should be perturbed one by one, the simulation is time consuming if the portfolio is very large. One advantage of Scenario Manager model is that it does not need to regenerate the curves and MC simulation paths when the obligors are perturbed one by one hence it is faster than the other three models. The time of MC simulation for the Scenario Manager model is of the order somewhere between O(N) ~ O(N2) ( N = number of obligors in the portfolio) depending on the value of cumulative hazard rates. However, those three models are between O(N2) ~ O(N3). 

It is possible to identify three main sources of numerical error between our test model and Scenario Manager model to account for small discrepancy. First, it is hard to generate same MC simulation paths for two models even if we use same random seed. Second, the day count convention, curve interpolation, and integration method may be different for two models. Finally, the senior tranches tend to have smaller ‘signal to noise’ ratio.
